<div ng-controller="ItemCtrl" ng-init="init()">
  <h2> 
    {{ item.name }}
  </h2>
  <small>{{ collection.name}} <a href="#/collections/{{collection.id}}/items">back</a></small>
  <p> {{ item.description }} </p>

  <div class="page-header">
    <h3>
      Details
      <div class="btn-group btn-group-sm pull-right">
        <a ng-click="openDetailModal(null, 'medidas')" class="btn btn-primary">+ Medidas</a>
        <a ng-click="openDetailModal(null, 'materiales')" class="btn btn-primary">+ Material</a>
      </div>
    </h3>
  </div>
  <table class="table table-hover">
    <thead>
      <th>
        <a ng-click="predicate = 'detail_type'; reverse=!reverse">
          Type
        </a>
        <span ng-show="predicate === 'detail_type' && reverse === true">&#x25B4;</span>
        <span ng-show="predicate === 'detail_type' && reverse === false">&#x25BE;</span>
      </th>
      <th>
        <a ng-click="predicate = 'name'; reverse=!reverse">
          Name
        </a>
        <span ng-show="predicate === 'name' && reverse === true">&#x25B4;</span>
        <span ng-show="predicate === 'name' && reverse === false">&#x25BE;</span>
      </th>
      <th>Value</th>
      <th>Actions</th>
    </thead>
    <tbody>
      <tr ng-repeat="detail in item_details | orderBy:predicate:reverse">
        <td>{{detail.detail_type }}</td>
        <td>{{ detail.name }}</td>
        <td>{{ detail.value }}</td>
        <td>
          <div class="btn-group btn-group-xs">
            <a ng-click="openDetailModal(detail, detail.detail_type)" class="btn btn-default">edit</a>
            <a ng-click="deleteDetail(detail)" class="btn btn-default">delete</a>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="page-header"> 
    <h4>
      Treatments
      <a ng-click="openTreatmentModal(null)" ng-hide="treatments.open" class="btn btn-primary btn-sm pull-right">+ Treatment</a>
    </h4>
  </div>
  <div class="panel panel-default" ng-repeat="treatment in item_treatments">
    <div class="panel-heading">
      <a ng-click="openTreatmentModal(treatment)">Treatment #{{ treatment.id }}</a>
      <span class="badge pull-right" ng-show="treatment.id == treatments.current">current</span>
    </div>
    <div class="panel-body">
      <p>{{ treatment.diagnosis}}</p>
      <p class="muted small-text">{{treatment.time_ago}}</p>
    </div>
  </div>
</div>
